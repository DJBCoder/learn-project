@[toc](项目实战---会员管理系统)

# 项目环境搭建
&emsp;&emsp;首先通过vue的命令创建项目，根据自己的需要选择配置项，这里的配置项如下：

![项目配置项](../images/01-笔记/01-项目配置项.png)

## 路由配置相关

1. 新建 *__src/router/routes.js__* 文件，该文件用来封装路由配置列表，内容如下：

```javascript
// src/router/routes.js 

const routes = [
    {
      path: '/',
      name: 'Home',
      // @代表src目录
      component: () => import('@/views/Home.vue')
    },
    {
      path: '/about',
      name: 'About',
      component: () => import('@/views/About.vue')
    }
  ]

  export default routes
```

&emsp;&emsp;后面所有的路由配置都写在这个文件中。

2. 修改 *__src/router/index.js__* 文件，导入刚才的路由配置表的文件，并在添加到路由对象中：

```javascript
// src/router/index.js

import Vue from 'vue'
import VueRouter from 'vue-router'
// 导入路由列表对象
import routes from './routes'

Vue.use(VueRouter)

const router = new VueRouter({
  mode: 'history',
  base: process.env.BASE_URL,
  // 引入路由列表对象
  routes
})

export default router
```

## Vuex项目路径配置
&emsp;&emsp;如果所有的状态都写在一个js文件中，这个 js必定会很臃肿，Vuex并不限制你的代码结构。建议按以下代码结构来构建项目结构:

```text
└── store 
    ├── index.js # 我们组装模块并导出store的地方 
    ├── actions.js # 根级别的 action 
    ├── mutations.js # 根级别的 mutation 
    ├── state.js # 根级别的 state
    ├── getters.js # 根级别的getters
    └── modules
        └── ... # 根据需要封装模块
```

1. 在 *__src/store__* 的目录下新建 *__actions.js、mutations.js、state.js和getters.js__* 文件，在这些文件中分别输入下面的代码：

```javascript
export default {

}
```

2. 在 *__src/store__* 的目录下新建 *__modules__* 的目录

3. 修改 *__src/store/index.js__* 文件：

```javascript
import Vue from 'vue'
import Vuex from 'vuex'
import actions from './actions'
import state from './state'
import mutations from './mutations'
import getters from './getters'

Vue.use(Vuex)

export default new Vuex.Store({
  state,
  mutations,
  actions,
  getters,
  modules: {
  }
})
```

> *__注意：当在modules目录中新建模块的时候，需要在src/store/index.js中引入，并在modules选项中添加引入__*

## Axios功能封装和解决跨域问题
### 方法一

1. 下载 axios

```shell
npm install axios -S
```

2. 创建 *__src/config/index.js__* 文件，在该文件中配置axios的基础路径：

```javascript
// 根据当前环境的不同配置跨域访问的基础路径
export const CFG_BASE_URL 
= process.env.NODE_ENV === 'production' ?
'http://production.com' : 
'http://localhost:5000'
```

3. 新建 *__src/lib/HttpRequest.js__* 文件，在该文件中封装自己的Axios

```javascript
// 引入axios
import axios from 'axios'
// 引入config中基础路径
import { CFG_BASE_URL } from '@/config'

// 创建封装的对象
class HttpRequest {
    // 构造函数
    constructor (baseurl = CFG_BASE_URL){
        this._baseUrl = baseurl
    }

    // 创建全局拦截器
    interceptors (instance) {
        // 请求拦截器
        instance.interceptors.request.use(
            config => {
                return config
            },
            error => {
                return Promise.reject(error)
            }
        )

        // 响应拦截器
        instance.interceptors.request.use(
            response => {
                return response
            },
            error => {
                return Promise.reject(error)
            }
        )
    }

    // 创建默认的配置项
    insideOptions () {
        return {
            baseURL : this._baseUrl
        }
    }

    // 创建请求
    // 参数： 1. options : 配置项
    // 返回值：Promise对象
    request (options) {
        // 创建axios对象
        const instance = axios.create()

        // 合并用户的配置和默认的配置
        options = Object.assign(this.insideOptions(), options)

        // 创建拦截器
        this.interceptors(instance)

        // 返回结果
        return instance(options)
    }
}

export default HttpRequest
```

3. 新建 *__src/api__* 目录（接口目录），项目的ajax请求都可以写在这个目录里面，作统一的管理

4. 新建一个 *__src/api/index.js__* 文件，用来创建封装好的axios类的实例

```javascript
// 导入封装好的axios对象
import HttpRequest from '../lib/HttpRequst'

export default new HttpRequest()
```

5. 新建一个 *__src/api/member.js__* （可以根据项目业务需求创建自己的api文件，这里的member.js是当前用来测试用的）实现具体的业务逻辑：

```javascript
// 导入封装好的axios实例
import axiosApi from '@/api'

export default {
    // 获取 member list
    getList () {
        // 向服务器发送get请求
        return axiosApi.request({
            method: 'get',
            url: '/member/list'
        })
    }
}
```

6. 在页面组件（.vue）中调用，比如下面的调用：

```html
<template>
  <div class="home">
    <button @click="handleClick">发送请求</button>
    {{list}}
  </div>
</template>

<script>
// 导入刚才编写好的api
import memberApi from '@/api/member'
export default {
  data() {
    return {
      list: []
    }
  },
  methods: {
    handleClick () {
      // 调用接口的方法
      memberApi.getList().then(response => {
        const resp = response.data
        if (resp.flag) {
          this.list = resp.data
        }
      })
    }
  },
}
</script>
```

> *__注意：要想获得具体的数据，需要后台服务，或者通过mockjs来模拟数据__*

### 方法二



## MockJS配置
&emsp;&emsp;Mock.js是用于生成随机数据，拦截Ajax请求。通过拦截Ajax请求，根据数据模板生成并返回模拟数据，让前端开发人员独立于后端进行开发，帮助编写单元测试。

1. 下载Mock.js，因为Mock.js只是在开发的时候才用到，所以下载到开发依赖下：

```shell
npm install mockjs -D
```

2. 新建 *__src/mock__* 目录，用来存放mock相关的功能

3. 新建 *__src/mock/index.js__* 文件，用来编写

## 其他基础配置

1. 资源文件相关目录修改

+ 新建 *__src/assets/img__* 目录，该目录下存放图片相关资源
+ 新建 *__src/assets/font__* 目录，该目录下存放字体资源

2. 项目全局配置文件

&emsp;&emsp;新建 *__src/config/index.js__* 文件，该文件中用来存放项目配置信息，比如：axios的基础路径：

```javascript
// src/config/index.js

// 根据当前环境的不同配置跨域访问的基础路径
export const CFG_BASE_URL 
= process.env.NODE_ENV === 'production' ?
'http://production.com' : 
'http://localhost:8898' 
```

&emsp;&emsp;在需要的地方导入这个变量就可以使用了。

3. 自定义指定目录

&emsp;&emsp;新建 *__src/directive/index.js__* 文件，用来存放vue的自定义指令。

4. 工具方法目录

&emsp;&emsp;新建 *__src/lib__* 目录，使用该目录存放工具方法文件：

+ tools.js：存放通用工具方法的函数
+ utils.js：与业务有关系的工具方法写在这个里面
+ 其他文件：根据业务需要整合的工具方法，比如可以自己封装aixos，将它保存在：HttpRequest.js文件中

